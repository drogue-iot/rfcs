# CLI drogue-cloud administration client

Spec out a CLI tool that helps administrate a drogue-cloud instance. 

## Overview 

The command line interface should be an administration tool to help users set up their drogue cloud environnement. 
It should follow the same style as `kubectl` does. 

## Name !
Proposals : 
* droguecli
* drgcli
* drgctl


## Scope

App management : create, list, delete.
Device management : create, read, update, delete, list.


### Proposed Usage

The general syntax is : `toolname $verb $resource $parameters`.


#### App operations


```
drgctl get apps
```
outputs:
```
myApp
yourApp
ourApp
theirApp
```

``` 
drgctl get app myApp
```
outputs:
```
{
   "name": "myApp"
   "info": "This is jb's app !",
   "aliases": ["theonlytrueapp", "theAppToRuleThemApps"]
}
```

Now let's write stuff: 

``` 
drgctl create app hisApp
```
outputs:
```
{
   "name": "hisApp"
   "info": "",
   "aliases": []
}
```

``` 
drgctl delete app hisApp
```
outputs:
```
deleting app "hisApp"....
app "hisApp" deleted.
```


#### Device operations


```
drgctl get devices 
#or
drgctl get devices --app=yourApp
```
outputs:
```
kitchenOven
bathroomThermometer
bedroomLight
DogCollar
```

``` 
drgctl get device kitchenOven --app=yourApp
```
outputs:
```
{
    metadata:{
        "application":"yourApp",
        "name":"kitchenOven"
   },
   spec:{
      "info": "This is the kitchen temp !",
      "credentials":{
          "credentials":[{"pass":topsecret"}]
      }
  }
}
```

``` 
drgctl delete device kitchenOven --app=yourApp
```
outputs:
```
device "kitchenOven" deleted.
```

``` 
drgctl edit device kitchenOven --app=yourApp 
```
spawns a vi to edit the resource as kubectl does.


*Note:* that makes a lot of `--app` ao it would be cool to have something like `droguectl config set-context --app=myApp` ?

### Misc

* Save and load a state. e.g. setting credentials so they can be reused un subsequent calls. i.e. `kubectl` remembers the URL of the cluster. A file could be used to store URL and token : 

```
~/.drogue-cloud-config.json
{
    url: "sandbox.drogue.cloud",
    token: "jfhglkjfkasdhfkjshflkjshflkjshflkjashf",
    defaultApp: "myApp"
}
```
To log in : 
```
drgctl login sandbox.drogue.cloud -u jib
# password prompted
```
then
``` 
drgctl config save ~/path/to/config
```
the config file path can be loaded from the `DROGUECONFIG` env variable. 

### Nice to have

* a nice `--help` or `-h` option.
* plural support to list resources. 
* Supporting shortands commands. e.g. `drg create dev mydevice` expanding into `drg create device mydevice`.
* ZSH autocompletion plugin !
